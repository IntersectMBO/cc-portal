import { Test, TestingModule } from '@nestjs/testing';
import { ConstitutionFacade } from './constitution.facade';
import { ConstitutionService } from '../services/constitution.service';
import { ConstitutionRedisService } from '../../redis/service/constitution-redis.service';
import { IpfsService } from '../../ipfs/services/ipfs.service';
import { CompareConstitutionsRequest } from '../api/request/compare-constitution.request';
import { ConstitutionDiffResponse } from '../api/response/constitution-diff.response';
import { ConstitutionDiffDto } from '../../redis/dto/constitution-diff.dto';
import { ConstitutionDto } from '../../redis/dto/constitution.dto';
import { IpfsContentDto } from '../../ipfs/dto/ipfs-content.dto';
import { ConstitutionResponse } from '../api/response/constitution.response';

describe('ConstitutionFacade', () => {
  let facade: ConstitutionFacade;

  const mockCompareConstitutionsRequest: CompareConstitutionsRequest = {
    base: 'bafkreiduhtn6y2i2gljbrqsabglndc6w4o2d6kzkv2dkm3ojtvnh2lzyoy',
    target: 'bafkreich5c3rbz4amwevqy676czysmr27ctby46zdhja7gnpzriyqwdv4i',
  };

  const mockConstitutionDiffResponse: ConstitutionDiffResponse = {
    diff: `"diff": "[{\"count\":1,\"removed\":true,\"value\":\"The morning sun cast a golden glow over the tranquil village, painting the cobblestone streets with warmth.\"},{\"count\":1,\"added\":true,\"value\":\"The morning sunlight cast a golden glow over the peaceful village, adorning the cobblestone streets with warmth.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Birds chirped melodiously, adding to the serene ambiance that enveloped the small community.\"},{\"count\":1,\"added\":true,\"value\":\"Birds chirped melodiously, contributing to the tranquil atmosphere that enveloped the tiny community.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Life moved at a leisurely pace here, far removed from the hustle and bustle of the city.\"},{\"count\":1,\"added\":true,\"value\":\"Life unfolded at a leisurely pace here, far from the hustle and bustle of city life.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Neighbors greeted each other with smiles and friendly nods as they went about their daily routines, weaving a tight-knit tapestry of camaraderie.\"},{\"count\":1,\"added\":true,\"value\":\"Residents greeted each other with smiles and friendly nods as they went about their daily routines, weaving a tightly knit fabric of camaraderie.\"},{\"count\":1,\"value\":\"\\n\\n\"},{\"count\":1,\"removed\":true,\"value\":\"In the heart of the village stood a quaint cafe, its aroma of freshly brewed coffee mingling with the scent of freshly baked pastries.\"},{\"count\":1,\"added\":true,\"value\":\"Nestled in the heart of the village stood a charming café, its aroma of freshly brewed coffee mingling with the scent of just-baked pastries.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"It was a haven for locals and travelers alike, offering a cozy sanctuary where conversations flowed as freely as the steaming cups of java.\"},{\"count\":1,\"added\":true,\"value\":\"It served as a sanctuary for locals and travelers alike, providing a cozy refuge where conversations flowed as freely as the steaming cups of joe.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Inside, the air buzzed with the gentle hum of chatter, punctuated by occasional bursts of laughter.\"},{\"count\":1,\"added\":true,\"value\":\"Inside, the air buzzed with the soft hum of chatter, punctuated by occasional bursts of laughter.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"The cafe's walls were adorned with local artwork, adding a splash of color to the rustic interior.\"},{\"count\":1,\"added\":true,\"value\":\"The café's walls were adorned with local artwork, adding a splash of color to the rustic ambiance.\"},{\"count\":1,\"value\":\"\\n\\n\"},{\"count\":1,\"removed\":true,\"value\":\"As the day unfolded, the village came alive with activity.\"},{\"count\":1,\"added\":true,\"value\":\"As the day progressed, the village teemed with activity.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Children skipped along the cobblestones, their laughter echoing through the narrow alleys.\"},{\"count\":1,\"added\":true,\"value\":\"Children skipped along the cobblestones, their laughter echoing through the narrow lanes.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Shopkeepers tended to their storefronts, arranging displays of goods with meticulous care.\"},{\"count\":1,\"added\":true,\"value\":\"Shopkeepers tended to their storefronts, arranging displays of goods with meticulous precision.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"And as the sun dipped below the horizon, casting a kaleidoscope of colors across the sky, the village settled into a peaceful tranquility once more, ready to embrace the promise of another day.\"},{\"count\":1,\"added\":true,\"value\":\"And as the sun dipped below the horizon, painting the sky with a kaleidoscope of colors, the village settled into a peaceful serenity once more, ready to embrace the promise of another day.\"},{\"count\":1,\"value\":\"\\n\"}]"
  `,
  };

  const mockConstitutionDiffDto: ConstitutionDiffDto = {
    base: 'bafkreibxlpnlpsg6ewqzxhslwyhzl4p4vc6bifj3nb4k2lxhbnfaojbmwy',
    target: 'bafkreich5c3rbz4amwevqy676czysmr27ctby46zdhja7gnpzriyqwdv4i',
    diff: `"diff": "[{\"count\":1,\"removed\":true,\"value\":\"The morning sun cast a golden glow over the tranquil village, painting the cobblestone streets with warmth.\"},{\"count\":1,\"added\":true,\"value\":\"The morning sunlight cast a golden glow over the peaceful village, adorning the cobblestone streets with warmth.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Birds chirped melodiously, adding to the serene ambiance that enveloped the small community.\"},{\"count\":1,\"added\":true,\"value\":\"Birds chirped melodiously, contributing to the tranquil atmosphere that enveloped the tiny community.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Life moved at a leisurely pace here, far removed from the hustle and bustle of the city.\"},{\"count\":1,\"added\":true,\"value\":\"Life unfolded at a leisurely pace here, far from the hustle and bustle of city life.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Neighbors greeted each other with smiles and friendly nods as they went about their daily routines, weaving a tight-knit tapestry of camaraderie.\"},{\"count\":1,\"added\":true,\"value\":\"Residents greeted each other with smiles and friendly nods as they went about their daily routines, weaving a tightly knit fabric of camaraderie.\"},{\"count\":1,\"value\":\"\\n\\n\"},{\"count\":1,\"removed\":true,\"value\":\"In the heart of the village stood a quaint cafe, its aroma of freshly brewed coffee mingling with the scent of freshly baked pastries.\"},{\"count\":1,\"added\":true,\"value\":\"Nestled in the heart of the village stood a charming café, its aroma of freshly brewed coffee mingling with the scent of just-baked pastries.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"It was a haven for locals and travelers alike, offering a cozy sanctuary where conversations flowed as freely as the steaming cups of java.\"},{\"count\":1,\"added\":true,\"value\":\"It served as a sanctuary for locals and travelers alike, providing a cozy refuge where conversations flowed as freely as the steaming cups of joe.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Inside, the air buzzed with the gentle hum of chatter, punctuated by occasional bursts of laughter.\"},{\"count\":1,\"added\":true,\"value\":\"Inside, the air buzzed with the soft hum of chatter, punctuated by occasional bursts of laughter.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"The cafe's walls were adorned with local artwork, adding a splash of color to the rustic interior.\"},{\"count\":1,\"added\":true,\"value\":\"The café's walls were adorned with local artwork, adding a splash of color to the rustic ambiance.\"},{\"count\":1,\"value\":\"\\n\\n\"},{\"count\":1,\"removed\":true,\"value\":\"As the day unfolded, the village came alive with activity.\"},{\"count\":1,\"added\":true,\"value\":\"As the day progressed, the village teemed with activity.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Children skipped along the cobblestones, their laughter echoing through the narrow alleys.\"},{\"count\":1,\"added\":true,\"value\":\"Children skipped along the cobblestones, their laughter echoing through the narrow lanes.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"Shopkeepers tended to their storefronts, arranging displays of goods with meticulous care.\"},{\"count\":1,\"added\":true,\"value\":\"Shopkeepers tended to their storefronts, arranging displays of goods with meticulous precision.\"},{\"count\":1,\"value\":\" \"},{\"count\":1,\"removed\":true,\"value\":\"And as the sun dipped below the horizon, casting a kaleidoscope of colors across the sky, the village settled into a peaceful tranquility once more, ready to embrace the promise of another day.\"},{\"count\":1,\"added\":true,\"value\":\"And as the sun dipped below the horizon, painting the sky with a kaleidoscope of colors, the village settled into a peaceful serenity once more, ready to embrace the promise of another day.\"},{\"count\":1,\"value\":\"\\n\"}]"
  `,
  };

  const mockConstitutionDto: ConstitutionDto = {
    cid: 'bafkreiduhtn6y2i2gljbrqsabglndc6w4o2d6kzkv2dkm3ojtvnh2lzyoy',
    version: '1713443693',
    blake2b: '8dcd9cbf2d28b947b7db091d0786b6e5951d4d7188717875081821d423c21249',
    contents: `The universe is a vast expanse filled with mysteries waiting to be unraveled. From the depths of space to the inner workings of atoms, scientists and explorers are constantly pushing the boundaries of our knowledge.\n\nHistory is a tapestry woven with the threads of countless events, each shaping the course of human civilization. From ancient civilizations like Egypt and Mesopotamia to the rise and fall of empires like Rome and Byzantium, history offers valuable lessons for the present and future.\n\nThe natural world is a marvel of complexity and beauty, teeming with life in all its forms. From towering mountains to lush rainforests, from the depths of the oceans to the vastness of the savannah, nature inspires awe and wonder.\n\nTechnology has revolutionized the way we live, work, and communicate. From the invention of the wheel to the advent of the internet, human ingenuity knows no bounds, driving progress and innovation at an unprecedented pace.\n\nArt is a window into the human soul, expressing emotions, ideas, and experiences in myriad forms. From cave paintings to classical sculptures, from Renaissance masterpieces to modern installations, art transcends time and culture, speaking to the universal human experience.\n\nLiterature is a treasure trove of wisdom and imagination, offering insights into the human condition and transporting readers to distant lands and times. From epic poems like the Iliad and the Odyssey to timeless classics like Shakespeare's plays and Dickens' novels, literature enriches our lives and expands our horizons.\n\nMusic is the universal language that speaks to the heart and soul, evoking emotions and memories with its melodies and rhythms. From Beethoven's symphonies to the Beatles' anthems, from jazz improvisations to hip-hop beats, music has the power to unite and inspire people around the world.\n\nPhilosophy is the quest for truth and meaning, exploring fundamental questions about existence, knowledge, ethics, and reality. From ancient thinkers like Socrates and Aristotle to modern philosophers like Kant and Nietzsche, philosophy continues to provoke thought and stimulate debate.\n\nReligion is a cornerstone of human culture, providing answers to life's big questions and guiding people's beliefs and practices. From Hinduism and Buddhism to Christianity and Islam, religion shapes the moral and spiritual fabric of societies around the world.\n\nPolitics is the arena where power, ideology, and governance intersect, shaping the course of nations and the lives of people. From democracies to dictatorships, from revolutions to reforms, politics reflects the complexities and contradictions of human society.\n\nEducation is the key to unlocking human potential, empowering individuals to learn, grow, and thrive. From early childhood education to lifelong learning, education opens doors to new opportunities and fosters personal and social development.\n\nHealth and wellness are essential components of a fulfilling life, encompassing physical, mental, and emotional well-being. From regular exercise and balanced nutrition to mindfulness and self-care, prioritizing health improves quality of life and longevity.\n\nTravel is a journey of discovery, opening minds and hearts to new cultures, landscapes, and experiences. From backpacking adventures to luxury vacations, travel broadens perspectives and fosters connections with people and places around the globe.\n\nRelationships are the bedrock of human connection, shaping our identities, emotions, and behaviors. From family bonds to friendships, from romantic partnerships to professional collaborations, relationships enrich our lives and provide support in times of need.\n\nWork is a central aspect of adult life, providing a means of income, purpose, and fulfillment. From blue-collar jobs to white-collar careers, from freelancing to entrepreneurship, work shapes our identities and contributes to the functioning of society.\n\nFood is more than sustenance; it is a cultural expression, a source of pleasure, and a way of bringing people together. From traditional cuisines to fusion dishes, from street food to fine dining, food reflects the diversity and creativity of human culture.\n\nFashion is a form of self-expression, reflecting personal style, identity, and cultural trends. From haute couture to streetwear, from seasonal collections to vintage finds, fashion shapes the way we present ourselves to the world.\n\nSports are a celebration of human athleticism, skill, and teamwork, captivating audiences around the world with their drama and excitement. From soccer and basketball to tennis and cricket, sports inspire passion and camaraderie among fans and athletes alike.\n\nEntertainment is a form of escapism, offering diversion and delight through movies, TV shows...`,
  };

  const mockIpfsContentDto: IpfsContentDto = {
    title: 'Revision 1',
    cid: 'bafkreiduhtn6y2i2gljbrqsabglndc6w4o2d6kzkv2dkm3ojtvnh2lzyoy',
    version: '1713443693',
    createdDate: '2024-04-21 11:21:59.334',
    contentType: 'text/markdown',
    blake2b: '8dcd9cbf2d28b947b7db091d0786b6e5951d4d7188717875081821d423c21249',
    contents: `The universe is a vast expanse filled with mysteries waiting to be unraveled. From the depths of space to the inner workings of atoms, scientists and explorers are constantly pushing the boundaries of our knowledge.\n\nHistory is a tapestry woven with the threads of countless events, each shaping the course of human civilization. From ancient civilizations like Egypt and Mesopotamia to the rise and fall of empires like Rome and Byzantium, history offers valuable lessons for the present and future.\n\nThe natural world is a marvel of complexity and beauty, teeming with life in all its forms. From towering mountains to lush rainforests, from the depths of the oceans to the vastness of the savannah, nature inspires awe and wonder.\n\nTechnology has revolutionized the way we live, work, and communicate. From the invention of the wheel to the advent of the internet, human ingenuity knows no bounds, driving progress and innovation at an unprecedented pace.\n\nArt is a window into the human soul, expressing emotions, ideas, and experiences in myriad forms. From cave paintings to classical sculptures, from Renaissance masterpieces to modern installations, art transcends time and culture, speaking to the universal human experience.\n\nLiterature is a treasure trove of wisdom and imagination, offering insights into the human condition and transporting readers to distant lands and times. From epic poems like the Iliad and the Odyssey to timeless classics like Shakespeare's plays and Dickens' novels, literature enriches our lives and expands our horizons.\n\nMusic is the universal language that speaks to the heart and soul, evoking emotions and memories with its melodies and rhythms. From Beethoven's symphonies to the Beatles' anthems, from jazz improvisations to hip-hop beats, music has the power to unite and inspire people around the world.\n\nPhilosophy is the quest for truth and meaning, exploring fundamental questions about existence, knowledge, ethics, and reality. From ancient thinkers like Socrates and Aristotle to modern philosophers like Kant and Nietzsche, philosophy continues to provoke thought and stimulate debate.\n\nReligion is a cornerstone of human culture, providing answers to life's big questions and guiding people's beliefs and practices. From Hinduism and Buddhism to Christianity and Islam, religion shapes the moral and spiritual fabric of societies around the world.\n\nPolitics is the arena where power, ideology, and governance intersect, shaping the course of nations and the lives of people. From democracies to dictatorships, from revolutions to reforms, politics reflects the complexities and contradictions of human society.\n\nEducation is the key to unlocking human potential, empowering individuals to learn, grow, and thrive. From early childhood education to lifelong learning, education opens doors to new opportunities and fosters personal and social development.\n\nHealth and wellness are essential components of a fulfilling life, encompassing physical, mental, and emotional well-being. From regular exercise and balanced nutrition to mindfulness and self-care, prioritizing health improves quality of life and longevity.\n\nTravel is a journey of discovery, opening minds and hearts to new cultures, landscapes, and experiences. From backpacking adventures to luxury vacations, travel broadens perspectives and fosters connections with people and places around the globe.\n\nRelationships are the bedrock of human connection, shaping our identities, emotions, and behaviors. From family bonds to friendships, from romantic partnerships to professional collaborations, relationships enrich our lives and provide support in times of need.\n\nWork is a central aspect of adult life, providing a means of income, purpose, and fulfillment. From blue-collar jobs to white-collar careers, from freelancing to entrepreneurship, work shapes our identities and contributes to the functioning of society.\n\nFood is more than sustenance; it is a cultural expression, a source of pleasure, and a way of bringing people together. From traditional cuisines to fusion dishes, from street food to fine dining, food reflects the diversity and creativity of human culture.\n\nFashion is a form of self-expression, reflecting personal style, identity, and cultural trends. From haute couture to streetwear, from seasonal collections to vintage finds, fashion shapes the way we present ourselves to the world.\n\nSports are a celebration of human athleticism, skill, and teamwork, captivating audiences around the world with their drama and excitement. From soccer and basketball to tennis and cricket, sports inspire passion and camaraderie among fans and athletes alike.\n\nEntertainment is a form of escapism, offering diversion and delight through movies, TV shows...`,
  };

  const mockConstitutionResponse: ConstitutionResponse = {
    cid: 'bafkreiduhtn6y2i2gljbrqsabglndc6w4o2d6kzkv2dkm3ojtvnh2lzyoy',
    version: 'Revision 1',
    contents: `The universe is a vast expanse filled with mysteries waiting to be unraveled. From the depths of space to the inner workings of atoms, scientists and explorers are constantly pushing the boundaries of our knowledge.\n\nHistory is a tapestry woven with the threads of countless events, each shaping the course of human civilization. From ancient civilizations like Egypt and Mesopotamia to the rise and fall of empires like Rome and Byzantium, history offers valuable lessons for the present and future.\n\nThe natural world is a marvel of complexity and beauty, teeming with life in all its forms. From towering mountains to lush rainforests, from the depths of the oceans to the vastness of the savannah, nature inspires awe and wonder.\n\nTechnology has revolutionized the way we live, work, and communicate. From the invention of the wheel to the advent of the internet, human ingenuity knows no bounds, driving progress and innovation at an unprecedented pace.\n\nArt is a window into the human soul, expressing emotions, ideas, and experiences in myriad forms. From cave paintings to classical sculptures, from Renaissance masterpieces to modern installations, art transcends time and culture, speaking to the universal human experience.\n\nLiterature is a treasure trove of wisdom and imagination, offering insights into the human condition and transporting readers to distant lands and times. From epic poems like the Iliad and the Odyssey to timeless classics like Shakespeare's plays and Dickens' novels, literature enriches our lives and expands our horizons.\n\nMusic is the universal language that speaks to the heart and soul, evoking emotions and memories with its melodies and rhythms. From Beethoven's symphonies to the Beatles' anthems, from jazz improvisations to hip-hop beats, music has the power to unite and inspire people around the world.\n\nPhilosophy is the quest for truth and meaning, exploring fundamental questions about existence, knowledge, ethics, and reality. From ancient thinkers like Socrates and Aristotle to modern philosophers like Kant and Nietzsche, philosophy continues to provoke thought and stimulate debate.\n\nReligion is a cornerstone of human culture, providing answers to life's big questions and guiding people's beliefs and practices. From Hinduism and Buddhism to Christianity and Islam, religion shapes the moral and spiritual fabric of societies around the world.\n\nPolitics is the arena where power, ideology, and governance intersect, shaping the course of nations and the lives of people. From democracies to dictatorships, from revolutions to reforms, politics reflects the complexities and contradictions of human society.\n\nEducation is the key to unlocking human potential, empowering individuals to learn, grow, and thrive. From early childhood education to lifelong learning, education opens doors to new opportunities and fosters personal and social development.\n\nHealth and wellness are essential components of a fulfilling life, encompassing physical, mental, and emotional well-being. From regular exercise and balanced nutrition to mindfulness and self-care, prioritizing health improves quality of life and longevity.\n\nTravel is a journey of discovery, opening minds and hearts to new cultures, landscapes, and experiences. From backpacking adventures to luxury vacations, travel broadens perspectives and fosters connections with people and places around the globe.\n\nRelationships are the bedrock of human connection, shaping our identities, emotions, and behaviors. From family bonds to friendships, from romantic partnerships to professional collaborations, relationships enrich our lives and provide support in times of need.\n\nWork is a central aspect of adult life, providing a means of income, purpose, and fulfillment. From blue-collar jobs to white-collar careers, from freelancing to entrepreneurship, work shapes our identities and contributes to the functioning of society.\n\nFood is more than sustenance; it is a cultural expression, a source of pleasure, and a way of bringing people together. From traditional cuisines to fusion dishes, from street food to fine dining, food reflects the diversity and creativity of human culture.\n\nFashion is a form of self-expression, reflecting personal style, identity, and cultural trends. From haute couture to streetwear, from seasonal collections to vintage finds, fashion shapes the way we present ourselves to the world.\n\nSports are a celebration of human athleticism, skill, and teamwork, captivating audiences around the world with their drama and excitement. From soccer and basketball to tennis and cricket, sports inspire passion and camaraderie among fans and athletes alike.\n\nEntertainment is a form of escapism, offering diversion and delight through movies, TV shows...`,
  };

  const mockConstitutionService = {
    diffConstitutions: jest.fn(
      async (currentFile: string, oldFile: string) => {},
    ),
  };

  const mockConstitutionRedisService = {
    saveConstitutionFile: jest.fn(),
    getConstitutionFileByCid: jest.fn(async (cid: string) => {
      return mockConstitutionDto;
    }),
    getConstitutionDiff: jest.fn(async (base: string, target: string) => {
      mockCompareConstitutionsRequest.base = base;
      mockCompareConstitutionsRequest.target = target;
      return mockConstitutionDiffDto;
    }),
  };

  const mockIpfsService = {
    addToIpfs: jest.fn(),
    getFromIpfs: jest.fn(),
    findCurrentMetadata: jest.fn(),
    findAllMetadata: jest.fn(),
  };

  beforeEach(async () => {
    const module: TestingModule = await Test.createTestingModule({
      providers: [
        ConstitutionFacade,
        { provide: ConstitutionService, useValue: mockConstitutionService },
        {
          provide: ConstitutionRedisService,
          useValue: mockConstitutionRedisService,
        },
        { provide: IpfsService, useValue: mockIpfsService },
      ],
    }).compile();

    facade = module.get<ConstitutionFacade>(ConstitutionFacade);
  });

  afterEach(() => {
    jest.clearAllMocks();
  });

  it('should be defined', () => {
    expect(facade).toBeDefined();
  });

  it('compareTwoConstitutionVersions => should return diff if it is directly stored in Redis', async () => {
    const mockCompareConstitutionsRequest: CompareConstitutionsRequest = {
      base: 'bafkreibxlpnlpsg6ewqzxhslwyhzl4p4vc6bifj3nb4k2lxhbnfaojbmwy',
      target: 'bafkreich5c3rbz4amwevqy676czysmr27ctby46zdhja7gnpzriyqwdv4i',
    };
    const result = await facade.compareTwoConstitutionVersions(
      mockCompareConstitutionsRequest,
    );
    expect(result).toEqual(mockConstitutionDiffResponse);
    expect(mockConstitutionRedisService.getConstitutionDiff).toHaveBeenCalled();
  });
  it('compareTwoConstitutionVersions => should return diff by getting files`   CIDs stored in Redis', async () => {
    const mockCompareConstitutionsRequest: CompareConstitutionsRequest = {
      base: 'bafkreibxlpnlpsg6ewqzxhslwyhzl4p4vc6bifj3nb4k2lxhbnfaojbmwy',
      target: 'bafkreich5c3rbz4amwevqy676czysmr27ctby46zdhja7gnpzriyqwdv4i',
    };
    mockConstitutionRedisService.getConstitutionDiff.mockResolvedValue(null);
    const result = await facade.compareTwoConstitutionVersions(
      mockCompareConstitutionsRequest,
    );
    expect(result).toEqual(mockConstitutionDiffResponse);
  });
});
